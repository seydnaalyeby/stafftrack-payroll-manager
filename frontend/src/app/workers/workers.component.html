<div class="workers-container">
  <!-- Header Section -->
  <div class="workers-header">
    <div class="header-content">
      <div class="header-text">
        <h1 class="page-title">{{ 'workers.title' | translate }}</h1>
        <p class="page-subtitle">{{ 'workers.search' | translate }}</p>
        <p class="date-display">{{ todayString }}</p>
      </div>
      <div class="header-actions">
        <button class="btn-primary" (click)="showAddWorkerForm()">
          <mat-icon>add</mat-icon>
          {{ 'workers.addWorker' | translate }}
        </button>
      </div>
    </div>
  </div>

  <!-- Search Section -->
  <div class="search-section">
    <form [formGroup]="searchForm">
      <div class="search-container">
        <mat-icon class="search-icon">search</mat-icon>
        <input 
          type="text" 
          placeholder="{{ 'workers.search' | translate }}..." 
          class="search-input"
          formControlName="searchTerm"
        >
      </div>
    </form>
  </div>

  <!-- Loading State -->
  <div class="loading-state" *ngIf="isLoading">
    <div class="loading-spinner">
      <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
    </div>
    <p class="loading-text">{{ 'common.loading' | translate }} {{ 'nav.workers' | translate }}...</p>
  </div>

  <!-- Add/Edit Worker Form -->
  <div class="worker-form-overlay" *ngIf="showAddForm || showEditForm">
    <div class="worker-form-container">
      <div class="form-header">
        <h2>{{ showAddForm ? ('workers.addWorker' | translate) : ('workers.editWorker' | translate) }}</h2>
        <button class="close-btn" (click)="hideForms()">
          <mat-icon>close</mat-icon>
        </button>
      </div>
      
      <form [formGroup]="workerForm" class="worker-form">
        <div class="form-row">
          <div class="form-group">
            <label for="name">{{ 'workers.name' | translate }} *</label>
            <input 
              id="name" 
              type="text" 
              formControlName="name" 
              class="form-input"
              placeholder="{{ 'workers.name' | translate }}"
            >
            <div class="error-message" *ngIf="workerForm.get('name')?.invalid && workerForm.get('name')?.touched">
              {{ 'workers.name' | translate }} {{ 'common.error' | translate }}
            </div>
          </div>
          
          <div class="form-group">
            <label for="phone">{{ 'workers.phone' | translate }} *</label>
            <input 
              id="phone" 
              type="tel" 
              formControlName="phone" 
              class="form-input"
              placeholder="{{ 'workers.phone' | translate }}"
            >
            <div class="error-message" *ngIf="workerForm.get('phone')?.invalid && workerForm.get('phone')?.touched">
              {{ 'workers.phone' | translate }} {{ 'common.error' | translate }}
            </div>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="position">{{ 'workers.position' | translate }} *</label>
            <select id="position" formControlName="position" class="form-input">
              <option value="">{{ 'common.select' | translate }} {{ 'workers.position' | translate }}</option>
              <option value="Manager">Manager</option>
              <option value="Developer">Developer</option>
              <option value="Designer">Designer</option>
              <option value="Accountant">Accountant</option>
              <option value="HR">HR</option>
              <option value="Sales">Sales</option>
            </select>
            <div class="error-message" *ngIf="workerForm.get('position')?.invalid && workerForm.get('position')?.touched">
              {{ 'workers.position' | translate }} {{ 'common.error' | translate }}
            </div>
          </div>
          
          <div class="form-group">
            <label for="monthlySalary">{{ 'workers.monthlySalary' | translate }} ($) *</label>
            <input 
              id="monthlySalary" 
              type="number" 
              formControlName="monthlySalary" 
              class="form-input"
              placeholder="{{ 'workers.monthlySalary' | translate }}"
              min="0"
              step="0.01"
            >
            <div class="error-message" *ngIf="workerForm.get('monthlySalary')?.invalid && workerForm.get('monthlySalary')?.touched">
              {{ 'workers.monthlySalary' | translate }} {{ 'common.error' | translate }}
            </div>
          </div>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="joinDate">{{ 'workers.joinDate' | translate }} *</label>
            <input 
              id="joinDate" 
              type="date" 
              formControlName="joinDate" 
              class="form-input"
            >
            <div class="error-message" *ngIf="workerForm.get('joinDate')?.invalid && workerForm.get('joinDate')?.touched">
              {{ 'workers.joinDate' | translate }} {{ 'common.error' | translate }}
            </div>
          </div>
          
          <div class="form-group">
            <label for="photoUrl">{{ 'workers.photoUrl' | translate }} (optional)</label>
            <input 
              id="photoUrl" 
              type="url" 
              formControlName="photoUrl" 
              class="form-input"
              placeholder="{{ 'workers.photoUrl' | translate }}"
            >
          </div>
        </div>
        
        <div class="form-actions">
          <button type="button" class="btn-secondary" (click)="hideForms()">{{ 'common.cancel' | translate }}</button>
          <button type="button" class="btn-primary" (click)="saveWorker()" [disabled]="workerForm.invalid || isLoading">
            <mat-icon *ngIf="!isLoading">{{ showAddForm ? 'add' : 'save' }}</mat-icon>
            <mat-progress-spinner *ngIf="isLoading" mode="indeterminate" diameter="20"></mat-progress-spinner>
            {{ showAddForm ? ('workers.addWorker' | translate) : ('workers.updateWorker' | translate) }}
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Workers Grid -->
  <div class="workers-grid" *ngIf="!isLoading">
    <div class="worker-card" *ngFor="let worker of filteredWorkers">
      <div class="card-header">
        <div class="worker-avatar">
          <img [src]="worker.photoUrl || 'assets/default-avatar.png'" [alt]="worker.name" class="avatar-img" *ngIf="worker.photoUrl">
          <mat-icon class="avatar-icon" *ngIf="!worker.photoUrl">person</mat-icon>
        </div>
        <div class="worker-info">
          <h3 class="worker-name">{{ worker.name }}</h3>
          <span class="worker-position" [style.color]="getPositionColor(worker.position)">
            {{ worker.position }}
          </span>
        </div>
      </div>
      
      <div class="card-body">
        <div class="worker-details">
          <div class="detail-item">
            <mat-icon class="detail-icon">phone</mat-icon>
            <span class="detail-text">{{ worker.phone }}</span>
          </div>
          <div class="detail-item">
            <mat-icon class="detail-icon">calendar_today</mat-icon>
            <span class="detail-text">Joined {{ worker.joinDate | date:'mediumDate' }}</span>
          </div>
          <div class="detail-item salary">
            <mat-icon class="detail-icon">payments</mat-icon>
            <span class="detail-text" [style.color]="getSalaryColor(worker.monthlySalary)">
              ${{ worker.monthlySalary | number:'1.2-2' }}/month
            </span>
          </div>
          <div class="detail-item">
            <mat-icon class="detail-icon">trending_up</mat-icon>
            <span class="detail-text">
              ${{ worker.dailySalary | number:'1.2-2' }}/day
            </span>
          </div>
        </div>
      </div>
      
      <div class="card-actions">
        <button class="action-btn edit" (click)="showEditWorkerForm(worker)" [attr.title]="'workers.editWorker' | translate">
          <mat-icon>edit</mat-icon>
        </button>
        <button class="action-btn delete" (click)="deleteWorker(worker.id)" [attr.title]="'common.delete' | translate">
          <mat-icon>delete</mat-icon>
        </button>
      </div>
    </div>
    
    <!-- Empty State -->
    <div class="empty-state" *ngIf="!isLoading && filteredWorkers.length === 0">
      <div class="empty-content">
        <mat-icon class="empty-icon">people</mat-icon>
        <h3 class="empty-title">{{ 'workers.noWorkersFound' | translate }}</h3>
        <p class="empty-message">{{ 'workers.tryAdjustingSearch' | translate }}</p>
        <button class="btn-primary" (click)="showAddWorkerForm()">
          <mat-icon>add</mat-icon>
          {{ 'workers.addWorker' | translate }}
        </button>
      </div>
    </div>

    <!-- No Search Results -->
    <div class="empty-state" *ngIf="filteredWorkers.length === 0 && workers.length > 0">
      <mat-icon class="empty-icon">search_off</mat-icon>
      <h3>{{ 'workers.noWorkersMatchSearch' | translate }}</h3>
      <p>{{ 'workers.tryAdjustingSearchCriteria' | translate }}</p>
      <button class="btn-secondary" (click)="searchForm.reset()">{{ 'common.clearSearch' | translate }}</button>
    </div>
  </div>
</div>
